# X Bookmark to Google Sheets

Xのタイムラインにブックマークボタンを追加し、Googleスプレッドシートに自動保存するChrome拡張機能です。

## 特徴

- Discord機能なし、Google Sheetsのみに特化
- スプレッドシート内で設定を完結
- App Scriptに触れない人でも簡単設定
- 緑色のボタンで Google Sheets をイメージ

## セットアップ手順

### 1. スプレッドシートの準備

1. 新しいGoogleスプレッドシートを作成
2. **設定用シートを作成**: シート名を「設定」に変更（画面下部のタブを右クリック→名前を変更）
3. **データ保存用シートを作成**: 「+」ボタンで新しいシートを追加し、任意の名前をつける（例：「ブックマーク」「ブックマーク2026」など）
4. 「設定」シートに以下の内容を入力：

| | A | B |
|--|---|---|
| 1 | 設定 | |
| 2 | スプレッドシートID | 実際のスプレッドシートID |
| 3 | シート名 | ブックマーク |

> **重要**: B3セルには、手順3で作成したデータ保存用シートの名前を正確に入力してください。ここで指定した名前のシートにブックマークが保存されます。

**スプレッドシートIDの取得方法:**
- スプレッドシートのURL: `https://docs.google.com/spreadsheets/d/[ここがID]/edit`
- `d/`と`/edit`の間の文字列をコピーしてB2セルに貼り付け

### 2. Google Apps Scriptの設定

1. 上記で作成したスプレッドシートを開いた状態で、メニューから **「拡張機能」→「Apps Script」** をクリック
2. 自動で開いたスクリプトエディタの既存コードを全て削除
3. `google-apps-script.js`の内容をコピー＆ペースト
4. 「保存」をクリック（Ctrl+S / Cmd+S）
5. 「デプロイ」→「新しいデプロイ」
6. 種類を「ウェブアプリ」に設定
7. 以下の設定を行う：
   - **実行ユーザー**: 自分
   - **アクセスできるユーザー**: 全員
8. 「デプロイ」をクリック
9. 初回は権限の承認が求められるので「アクセスを承認」→ Googleアカウントを選択 → 「詳細」→「（プロジェクト名）に移動」→「許可」
10. 生成されたURLをコピー

### 3. Chrome拡張機能のインストール

1. `chrome://extensions/`を開く
2. 「デベロッパーモード」を有効にする
3. 「パッケージ化されていない拡張機能を読み込む」をクリック
4. `x-bookmark-to-sheets`フォルダを選択

### 4. 拡張機能の設定

1. 拡張機能アイコンをクリック
2. Google Apps ScriptのWebhook URLを入力
3. 「保存」をクリック

## 使用方法

1. X（Twitter）のページを開く
2. ツイートのアクションバーに緑色のブックマークボタンが表示される
3. クリックするとGoogleスプレッドシートに保存される

## 保存されるデータ

- **日時**: ツイートの投稿日時
- **ユーザー名**: ツイートしたユーザー名
- **ツイート内容**: ツイートの本文
- **URL**: ツイートのURL
- **文字数**: ツイートの文字数
- **保存時刻**: ブックマークした時刻

## トラブルシューティング

### ボタンが表示されない
- ページをリロードしてみてください
- 拡張機能が有効になっているか確認してください

### 保存されない
- Google Apps ScriptのURLが正しく設定されているか確認
- スプレッドシートの設定（A1〜B3）が正しいか確認
- Google Apps Scriptの実行ログでエラーを確認

### エラーが発生する
- スプレッドシートIDが正しいか確認
- Google Apps Scriptのアクセス権限が「全員」になっているか確認

## ファイル構成

```
x-bookmark-to-sheets/
├── manifest.json              # 拡張機能の設定
├── content.js                 # メインスクリプト
├── popup.html                 # 設定画面
├── popup.js                   # 設定画面のロジック
├── background.js              # バックグラウンドスクリプト
├── styles.css                 # スタイルシート
├── google-apps-script.js      # Google Apps Script用コード
├── icon16.png                 # アイコン（16x16）
├── icon48.png                 # アイコン（48x48）
├── icon128.png                # アイコン（128x128）
└── README.md                  # この説明書
```

## 注意事項

- Google Apps Scriptは無料版では実行回数に制限があります
- 大量のツイートを保存する場合は制限にご注意ください
- スプレッドシートの権限設定にご注意ください
